name: Trigger Site Rebuild on a CRON Schedule

on:
  workflow_dispatch:
  schedule:
    # Runs "at minute 15 past every hour" (see https://crontab.guru)
    - cron: "15 * * * *"
jobs:
  build:
    name: Post tweet to twitter
    runs-on: ubuntu-latest
    env:
      TWITTER_CONSUMER_KEY: ${{secrets.TWITTER_CONSUMER_KEY}}
      TWITTER_CONSUMER_SECRET: ${{secrets.TWITTER_CONSUMER_SECRET}}
      TWITTER_ACCESS_TOKEN_KEY: ${{secrets.TWITTER_ACCESS_TOKEN_KEY}}
      TWITTER_ACCESS_TOKEN_SECRET: ${{secrets.TWITTER_ACCESS_TOKEN_SECRET}}

    steps:
      - name: cURL request
        uses: distributhor/workflow-webhook@v2
        env:
          webhook_url: "https://www.dca-cc.com/api/twitter/tweet"
          webhook_secret: "${{secrets.TWITTER_CONSUMER_KEY}}"
          data: '{ "consumer_key": "${{secrets.TWITTER_CONSUMER_KEY}}", "consumer_secret": "${{secrets.TWITTER_CONSUMER_SECRET}}", "access_token_key": "${{secrets.TWITTER_ACCESS_TOKEN_KEY}}", "access_token_secret": "${{secrets.TWITTER_ACCESS_TOKEN_SECRET}}" }'
